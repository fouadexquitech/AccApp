<app-nav></app-nav>
<section>

    <nav aria-label="breadcrumb" class="p-2" style="height: 32px;">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a [routerLink]="['/']">Home</a></li>
            <li class="breadcrumb-item active" aria-current="page">Assign Packages</li>
        </ol>
    </nav>
    <div class="container-fluid">
        <div class="row"  >     
                <div class="col-12">
            
                    <div class="card">
                        <div class="card-header" style="height: 30px;">
                            <h5 style="display: inline-block;">Search</h5>
                            <span style="float: right; cursor: pointer;user-select: none;" (click)="toggleShow()">show /
                                hide</span>
                        </div>
            
                        <div class="card-body" *ngIf="isShown">
                            <div class="row" style="height: 35px;" >
                                <div class="col-sm-2 form-group" >
                                    <!--<label>BOQ Div</label>
                                            <ng-select2 [(ngModel)]="SearchInput.bOQDiv" width="100%" [options]="select2Options" *ngIf="BOQDivList">
                                                <option value="" selected></option>
                                                <option *ngFor="let item of BOQDivList" [ngValue]="item.sectionO">{{ item.sectionO }}
                                                </option>
                                            </ng-select2>-->
            
                                    <mat-form-field class="full-width-field" style="width: 100%;font-size:10px;"  >
                                        <mat-label>BOQ Div</mat-label>
                                        <mat-select style="font-size:12px;" [(ngModel)]="SearchInput.bOQDiv" multiple>
                                            <input matInput type="text" focused="'true'" (keyup)="filterBOQDiv($event)"
                                                class="mat-filter">
                                            <span class="fa fa-search input-icon"></span>
                                            <mat-divider></mat-divider>
            
                                            <mat-option style="font-size:14px;" *ngFor="let item of selectedBOQDivList" [value]="item.sectionO">{{
                                                item.sectionO }}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
            
                                <div class="col-sm-2 form-group">
                                    <!-- appearance="fill" -->
                                    <mat-form-field  class="full-width-field" style="width: 100%;font-size:10px;" >  
                                        <mat-label>Level 2</mat-label>
                                        <mat-select style="font-size:12px;" [(ngModel)]="SearchInput.boqLevel2" multiple
                                            (ngModelChange)="GetRessourcesListByLevels()">
                                            <input matInput type="text" focused="'true'" (keyup)="filterBOQLevel($event)"
                                                class="mat-filter">
                                            <span class="fa fa-search input-icon"></span>
                                            <mat-divider></mat-divider>
            
                                            <mat-option style="font-size:14px;" *ngFor="let item of selectedBOQLevel2List" [value]="item.level">{{
                                                item.level }}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                                <!-- <div class="col-sm-2 form-group" >
                                            <label style="font-size: smaller ;" >Level 3</label>
                                            <input type="text" class="form-control" [(ngModel)]="SearchInput.boqLevel3" style="font-size: smaller ;height: 25px;"  >
                                        </div> -->
                                <div class="col-sm-2 form-group">
                                    <mat-form-field  class="full-width-field" style="width: 100%;font-size:10px;" >
                                        <mat-label>Level 3</mat-label>
                                        <mat-select style="font-size:12px;" [(ngModel)]="SearchInput.boqLevel3" multiple
                                            (ngModelChange)="GetRessourcesListByLevels()">
                                            <input matInput type="text" focused="'true'" (keyup)="filterBOQLevel3($event)"
                                                class="mat-filter">
                                            <span class="fa fa-search input-icon"></span>
                                            <mat-divider></mat-divider>
            
                                            <mat-option style="font-size:14px;" *ngFor="let item of selectedBOQLevel3List" [value]="item.level">{{
                                                item.level }}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
            
                                <div class="col-sm-2 form-group">
                                    <mat-form-field class="full-width-field" style="width: 100%;font-size:10px;" >
                                        <mat-label>Level 4</mat-label>
                                        <mat-select style="font-size:12px;" [(ngModel)]="SearchInput.boqLevel4" multiple
                                            (ngModelChange)="GetRessourcesListByLevels()">
                                            <input matInput type="text" focused="'true'" (keyup)="filterBOQLevel4($event)"
                                                class="mat-filter">
                                            <span class="fa fa-search input-icon"></span>
                                            <mat-divider></mat-divider>
            
                                            <mat-option style="font-size:14px;" *ngFor="let item of selectedBOQLevel4List" [value]="item.level">{{
                                                item.level }}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
            
                                <div class="col-sm-2 form-group">
                                    <!-- <label style="font-size: smaller ;">BOQ Item</label> -->
                                    <input type="text" #inputText class="form-control" [(ngModel)]="SearchInput.bOQItem" placeholder="BOQ Item"
                                        [ngClass]="{'selected-input': SearchInput.bOQItem }"
                                        style="font-size: smaller ;height: 25px;" >
                                </div>
            
                                <div class="col-sm-2 form-group">
                                    <!-- <label style="font-size: smaller ;">BOQ Desc</label> -->
                                    <input type="text" #inputText1 class="form-control" [(ngModel)]="SearchInput.bOQDesc" placeholder="BOQ Desc"
                                        [ngClass]="{'selected-input': SearchInput.bOQDesc }"
                                        style="font-size: smaller ;height: 25px;">
                                </div>
                            </div>
            
                            <div class="row" style="height: 35px;">
                                <div class="col-sm-1 form-group">
                                    <!-- <label style="font-size: smaller ;">From Row</label> -->
                                    <input id="fromRow" type="text" class="form-control" [(ngModel)]="SearchInput.fromRow" placeholder="From Row"
                                        [ngClass]="{'selected-input': SearchInput.fromRow }"
                                        style="font-size: smaller ;height: 25px;">
                                </div>
            
                                <div class="col-sm-1 form-group">
                                    <!-- <label style="font-size: smaller ;">To Row</label> -->
                                    <input type="text" class="form-control" [(ngModel)]="SearchInput.toRow" placeholder="To Row"
                                        [ngClass]="{'selected-input': SearchInput.toRow }"
                                        style="font-size: smaller ;height: 25px;">
                                </div>
            
                                <div class="col-sm-2 form-group">
                                    <!-- <label style="font-size: smaller ;">Trade Description</label> -->
                                    <input type="text" class="form-control" [(ngModel)]="SearchInput.obTradeDesc" placeholder="Trade Description"
                                        [ngClass]="{'selected-input': SearchInput.obTradeDesc }"
                                        style="font-size: smaller ;height: 25px;">
                                </div>
            
                                <div class="col-sm-2 form-group">
                                    <!--                         
                                        <label>Package</label>
                            
                                <ng-select2 [(ngModel)]="SearchInput.package" *ngIf="PackageList" width="100%">
                                    <option selected value=""></option>
                                    <option *ngFor="let item of PackageList" [ngValue]="item.idPkge">{{ item.pkgeName}}
                                    </option>
                                </ng-select2>-->
                                    <mat-form-field  class="full-width-field" style="width: 100%;font-size:10px;">
                                        <mat-label style="font-size:14px; ">Sheet Desc</mat-label>
                                        <mat-select style="font-size:12px;" [(ngModel)]="SearchInput.sheetDesc">
                                            <input matInput type="text" focused="'true'" (keyup)="filterSheetDesc($event)"
                                                class="mat-filter">
                                            <span class="fa fa-search input-icon"></span>
                                            <mat-divider></mat-divider>
                                            <mat-option></mat-option>
                                            <mat-option style="font-size:14px;" *ngFor="let item of selectedSheetDescList" [value]="item.obSheetDesc">{{
                                                item.obSheetDesc }}</mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
            
                                <div class="col-sm-2 form-group">
                                    <!--<label>Sheet Desc</label>
                                                       
                                                            <ng-select2 [(ngModel)]="SearchInput.sheetDesc" width="100%" [allowClear]="true" [placeholder]="" *ngIf="SheetDescList">
                                                                <option selected value=""></option>
                                                                <option *ngFor="let item of SheetDescList" [ngValue]="item.obSheetDesc">{{
                                                                    item.obSheetDesc }}</option>
                                                            </ng-select2>-->
                                    <mat-form-field  class="full-width-field" style="width: 100%;font-size:10px;">
                                        <mat-label style="font-size:14px; ">Assigned BOQ</mat-label>
                                        <mat-select style="font-size:14px;" [(ngModel)]="SearchInput.isItemsAssigned">
                                            <!-- <input matInput type="text" focused="'true'"
                                                        (keyup)="filterSearchPackages($event)" class="mat-filter"> -->
                                            <!-- <span class="fa fa-search input-icon"></span> -->
                                            <mat-divider></mat-divider>
                                            <mat-option [value]="0"> </mat-option>
                                            <mat-option [value]="1"> With Assigned Packages</mat-option>
                                            <mat-option [value]="2"> Without Assigned Packages</mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
            
                                <div class="col-sm-4 form-group">
                                    <!--<label>Sheet Desc</label>
                                                       
                                                            <ng-select2 [(ngModel)]="SearchInput.sheetDesc" width="100%" [allowClear]="true" [placeholder]="" *ngIf="SheetDescList">
                                                                <option selected value=""></option>
                                                                <option *ngFor="let item of SheetDescList" [ngValue]="item.obSheetDesc">{{
                                                                    item.obSheetDesc }}</option>
                                                            </ng-select2>-->
                                    <mat-form-field  class="full-width-field" style="width: 100%;font-size:10px;">
                                        <mat-label style="font-size:14px; ">Packages</mat-label>
                                        <mat-select style="font-size:12px;" [(ngModel)]="SearchInput.package">
                                            <input matInput type="text" focused="'true'" (keyup)="filterSearchPackages($event)"
                                                class="mat-filter">
                                            <span class="fa fa-search input-icon"></span>
                                            <mat-divider></mat-divider>
                                            <mat-option></mat-option>
                                            <mat-option style="font-size:14px;" *ngFor="let pitem of selectedFilterPackages" [value]="pitem.idPkge">
                                                {{ pitem.pkgeName }}</mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
            
                            </div>
            
                            <div class="row" style="height: 35px;">
                                <div class="col-sm-2 form-group">
            
                                    <!-- <label>RES Div</label>
                            
                                <ng-select2 [(ngModel)]="SearchInput.rESDiv" *ngIf="RESDivList" width="100%" [allowClear]="true" [placeholder]="">
                                    <option selected value=""></option>
                                    <option *ngFor="let item of RESDivList" [ngValue]="item.boqDiv">{{item.boqDiv}}</option>
                                </ng-select2>-->
            
                                    <mat-form-field class="full-width-field" style="width: 100%;font-size:10px;">
                                        <mat-label style="font-size:14px;">RES Div</mat-label>
                                        <mat-select style="font-size:12px;" [(ngModel)]="SearchInput.rESDiv" multiple>
                                            <input matInput type="text" focused="'true'" (keyup)="filterRESDiv($event)"
                                                class="mat-filter">
                                            <span class="fa fa-search input-icon"></span>
                                            <mat-divider></mat-divider>
            
                                            <mat-option style="font-size:14px;" *ngFor="let item of selectedRESDivList" [value]="item.boqDiv">{{
                                                item.boqDiv }}</mat-option>
                                        </mat-select>
                                    </mat-form-field>
            
            
                                </div>
            
                                <div class="col-sm-2 form-group">
            
                                    <!-- <label>RES Type</label>
                            
                                <ng-select2 [(ngModel)]="SearchInput.rESType" width="100%" [allowClear]="true" [placeholder]="" *ngIf="RESTypeList">
                                    <option selected value=""></option>
                                    <option *ngFor="let item of RESTypeList" [ngValue]="item.boqCtg">{{item.boqCtg}}
                                    </option>
                                </ng-select2>-->
            
                                    <mat-form-field  class="full-width-field" style="width: 100%;font-size:10px;">
                                        <mat-label style="font-size:14px; ">RES Type</mat-label>
                                        <mat-select style="font-size:12px;" [(ngModel)]="SearchInput.rESType"  (ngModelChange)="GetRessourcesListByLevels()" multiple>
                                            <input matInput type="text" focused="'true'" (keyup)="filterSearchRESType($event)"
                                                class="mat-filter">
                                            <span class="fa fa-search input-icon"></span>
                                            <mat-divider></mat-divider>
            
                                            <mat-option style="font-size:14px;" *ngFor="let item of selectedRESTypeList" [value]="item.boqCtg">{{
                                                item.boqCtg }}</mat-option>
                                        </mat-select>
                                    </mat-form-field>
            
                                </div>
            
                                <div class="col-sm-2 form-group">
                                    <!-- <label style="font-size: smaller ;">RES Description</label> -->
                                    <input type="text" class="form-control" [(ngModel)]="SearchInput.rESDesc" placeholder="RES Description"
                                        [ngClass]="{'selected-input': SearchInput.rESDesc }"
                                        style="font-size: smaller ;height: 25px;">
                                </div>
            
                                <div class="col-sm-2 form-group">
                                    <table>
                                        <tr><td>
                                    <mat-form-field  class="full-width-field" style="width: 100%;font-size:10px;">
                                        <mat-label style="font-size:14px; ">Ressources Selected</mat-label>
                                        <mat-select style="font-size:12px;" [(ngModel)]="SearchInput.boqResourceSeq" multiple class="custom-color">
                                            <input matInput type="text" focused="'true'" (keyup)="filterSearchRessources($event)"
                                                class="mat-filter">
                                            <span class="fa fa-search input-icon"></span>
                                            <mat-divider></mat-divider>
                                            <mat-option></mat-option>
                                            <mat-option style="font-size:14px;" *ngFor="let pitem of selectedFilterRessources" [value]="pitem.resSeq">
                                                {{ pitem.resDesc }}</mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                    
                                </td>
                            <td>
                                <!-- <button type="button" class="btn btn-primary" style="width: 10%;font-size:10px;"  (click)="clearSelRes()">Clear</button> -->
                            </td>
                            </tr>
                                </table>
                                </div>
            
                                <div class="col-sm-4 form-group">
                                    <!--<label>RES Package</label>
                            
                                <ng-select2 [(ngModel)]="SearchInput.rESPackage" width="100%" [allowClear]="true" [placeholder]="" *ngIf="RESPackageList">
                                    <option selected value=""></option>
                                    <option *ngFor="let item of RESPackageList" [ngValue]="item.boqPackage">{{
                                        item.boqPackage }}</option>
                                </ng-select2>-->
            
                                    <!-- <mat-form-field appearance="fill" class="full-width-field" style="font-size: smaller ;">
                                        <mat-label>RES Package</mat-label>
                                        <mat-select [(ngModel)]="SearchInput.rESPackage">
                                            <input matInput type="text" focused="'true'" (keyup)="filterSearchRESPackage($event)"
                                                class="mat-filter">
                                            <span class="fa fa-search input-icon"></span>
                                            <mat-divider></mat-divider>
                                            <mat-option></mat-option>
                                            <mat-option *ngFor="let item of selectedFilterResPackages" [value]="item.boqPackage">{{
                                                item.boqPackage }}</mat-option>
                                        </mat-select>
                                    </mat-form-field> -->

                                    <mat-form-field  class="full-width-field" style="width: 100%;font-size:10px;">
                                        <mat-label style="font-size:14px; ">Assigned Ressources</mat-label>
                                        <mat-select style="font-size:14px;" [(ngModel)]="SearchInput.isRessourcesAssigned">
                                            <!-- <input matInput type="text" focused="'true'"
                                                        (keyup)="filterSearchPackages($event)" class="mat-filter"> -->
                                            <!-- <span class="fa fa-search input-icon"></span> -->
                                            <mat-divider></mat-divider>
                                            <mat-option   [value]="0"></mat-option>
                                            <mat-option   [value]="1"> With Assigned Ressources</mat-option>
                                            <mat-option  [value]="2"> Without Assigned Ressources</mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                            </div>
            
                            <!-- <hr> -->
                            <div class="row">
                                <div class="col-sm-2 form-group">
                                    <button type="button" class="btn btn-primary" [disabled]="isSearching"
                                        style="float: right; width: 100%;font-size: small" (click)="onSearch()">
                                        <i class="fa fa-spinner fa-spin" *ngIf="isSearching"></i>
                                        Search</button>
                                </div>
                                <div class="col-sm-2 form-group">
                                    <button type="button" class="btn btn-primary" style="float: right; width: 100%;font-size: small"
                                        (click)="clearAllSearch()">Clear Search</button>
                                </div>
                                <div class="col-sm-2 form-group">
                                    <button type="button" class="btn btn-danger" style="float: right; width: 100%;font-size: small"
                                        (click)="clearAllSelections()" [disabled]="SelectedOriginalBoqList.length == 0">Clear All
                                        Selections</button>
                                </div>
                                <div class="col-sm-2 form-group">
                                    <button class="btn btn-success" (click)="ExportExcelBoq()" [disabled]="isSearching"
                                        style="width: 200px;font-size: small;">
                                        <!-- <i class="fa fa-spinner fa-spin" *ngIf="isSearching"></i> -->
                                        Export Selected Ressources
                                    </button>
                                </div>
                                <div class="col-sm-2 form-group">
                                    <button class="btn btn-success" (click)="ExportExcelPackagesCost()" [disabled]="isSearching"
                                        style="width: 250px;font-size: small;">
                                        Export Assigned Packages Dry Cost
                                    </button>
                                </div>
                            </div>
            
                        </div>
                    </div>
                </div>
        </div>

       
        <div class="row" >
            <div class="col-12">
                <div class="card">
                    <div class="card-header"  style="height: 30px;">
                        <h5 style="display: inline-block">Assign Package / Fill Trade Description</h5>
                        <span style="float: right; cursor: pointer;user-select: none;" (click)="toggleAssignShow()">show
                            /
                            hide</span>
                    </div>
                    <div class="card-body" *ngIf="isAssignShown">
                        <div class="row" style="height: 35px;">
                            <div class="col-sm-6 form-group">
                                <!--<label>Package</label>
                        
                            <ng-select2 [(ngModel)]="SelectedPackage" width="100%" [allowClear]="true" [placeholder]="" *ngIf="PackageList"
                            (ngModelChange)="onPackageSelected($event)">
                                <option value="" selected></option>
                                <option *ngFor="let pitem of PackageList" [ngValue]="pitem.idPkge">{{ pitem.pkgeName }}
                                </option>
                            </ng-select2>-->

                            <!-- appearance="fill" -->
                                <mat-form-field  class="full-width-field"  style="width: 100%;font-size:11px;">
                                    <mat-label style="font-size:14px;">Packages</mat-label>
                                    <mat-select style="font-size:12px;" [(ngModel)]="SelectedPackage" (selectionChange)="onPackageMatSelected($event)">
                                        <input matInput type="text" focused="'true'" (keyup)="filterPackages($event)"
                                            class="mat-filter">
                                        <span class="fa fa-search input-icon"></span>
                                        <mat-divider></mat-divider>
                                        <mat-option></mat-option>
                                        <mat-option style="font-size:14px;" *ngFor="let pitem of selectedPackages" [value]="pitem.idPkge">{{
                                            pitem.pkgeName }}</mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>

                            <!-- <div class="col-sm-6 form-group">
                                <form [formGroup]="formTrade">
                                     <label>Trade Description</label> 
                                    <input type="text" formControlName="tradeDesc" class="form-control" placeholder="Trade Description">
                                </form>
                            </div> -->
                        </div>

                        <!-- <hr> -->

                        <div class="row" style="height: 30px;">
                            <div class="col-sm-2 form-group">
                                <button [disabled]="isAssigning" type="button" class="btn btn-primary"
                                    style="float: right; width: 100%;font-size: small"
                                    [disabled]="(SelectedOriginalBoqList.length == 0 && SelectedBoqList.length == 0) || this.SelectedPackage==0"
                                    (click)="AssignPackages()">
                                    <span *ngIf="isAssigning" class="spinner-border spinner-border-sm mr-1"></span>
                                    Assign Package
                                </button>
                            </div>

                            <div class="col-sm-2 form-group">
                                <button style="float: right; width: 100%;font-size: small"type="button" class="btn btn-success"
                                    [disabled]="this.SelectedPackage==0" (click)="validateExcelBeforeAssign()">
                                    <!-- <div class="col-sm-3 form-group" *ngIf="FilePath == null"> 
                                  <button style="width: 100%;" type="button" class="btn btn-success"
                                [disabled]="(FilePath != null || isValidatingExcel)"
                                (click)="validateExcelBeforeAssign()"> -->
                                    <!-- <i class="fa fa-spinner fa-spin" *ngIf="isValidatingExcel"></i>
                                Validate Excel</button> -->

                                    <i class="fa fa-spinner fa-spin" *ngIf="(isValidatingExcel)"></i>
                                    Validate Excel</button>
                            </div>

                            <div class="col-sm-2 form-group form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="flexSwitchCheckDefault" style="font-size: 12px;"
                                    name="flexSwitchCheckDefault" [checked]="assignByBoqOnly == '1'"
                                    (change)="flexSwitchCheckDefaultChange($event)">
                                <label class="form-check-label" for="flexSwitchCheckDefault">By Boq Item Only</label>
                            </div>


                            <!-- <div class="col-sm-6 form-group">
                                <button type="button" class="btn btn-secondary" style="float: right; width: 100%;"
                                    (click)="updateBoqTradeDescription()">
                                    <span *ngIf="isAssigning" class="spinner-border spinner-border-sm mr-1"></span>
                                    Update Trade Description
                                </button>
                            </div> -->
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <div class="row">
            <div class="col-sm-12">
                <div class="card">
                    <div class="card-body">

                        <table id="originalBOQTable"  datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger"
                            class="row-border hover">
                            <thead>
                                <tr>
                                    <th scope="col">
                                        <input type="checkbox" [(ngModel)]="checkboxesAll" class="form-check-input"
                                            (change)="checkAllOriginalBoq2($event)">
                                    </th>
                                    <th scope="col">Row#</th>
                                    <th scope="col">Div</th>
                                    <th scope="col">BOQ Item</th>
                                    <th scope="col" style="width: 30%;">BOQ Description</th>
                                    <th scope="col">Trade Description</th>
                                    <th scope="col">Unit</th>
                                    <th scope="col">Bill Qty</th>
                                    <th scope="col">Final Qty</th>
                                    <th scope="col">RFQ. Qty</th>
                                    <th scope="col"></th>
                                    <th scope="col">Unit Price</th>
                                    <th scope="col">Assigned Package</th>
                                    <th scope="col">Status</th>
                                    <th scope="col"></th>
                                </tr>
                            </thead>
                            <!--<tbody *ngIf="isSearching && OriginalBoqList.length == 0">
                                <tr>
                                    <td colspan="15" style="text-align: center;">
                                        <mat-progress-bar [mode]="'indeterminate'"></mat-progress-bar>
                                    </td>
                                </tr>
                            </tbody>-->
                            <tbody>
                                <tr *ngFor="let item of OriginalBoqList ; let i = index" style="cursor: pointer;"
                                    (click)="selectRow($event, i)"
                                    [ngClass]="{'HighlightedRow': i === CurrentRowIndex }">
                                    <td><input disabled #checkboxes class="form-check-input" style="cursor: pointer;" type="checkbox" [checked]="item.isSelected"></td>
                                    <!-- <td><input #checkboxes class="form-check-input" style="cursor: pointer;" type="checkbox" [checked]="item.isSelected"></td> -->
                                    <td>{{item.rowNumber}}</td>
                                    <td>{{item.sectionO}}</td>
                                    <td>{{item.itemO}}</td>
                                    <td>{{item.descriptionO}}</td>
                                    <td>{{item.obTradeDesc}}</td>
                                    <td>{{item.unitO}}</td>
                                    <td>{{item.billQtyO | number: '.2' }}</td>
                                    <td>{{item.qtyO | number: '.2' }}</td>
                                    <td>{{item.scopeQtyO | number: '.2' }}</td>
                                    <td><a class="btn btn-link" title="Edit"
                                            (click)="editOriginalBoqQty(editModal,item)"><i class="fa-solid fa-edit"></i></a></td>
                                    <td>{{item.unitRate | number: '.2' }}</td>
                                    <td [ngClass]="item.assignedPackage != '' ? 'text-danger' : ''">
                                        {{item.assignedPackage}}</td>
                                    <td [ngClass]="item.boqStatus != '' ? 'text-danger' : ''"> {{item.boqStatus}}</td>
                                    <td> </td>
                                </tr>
                            </tbody>

                        </table>
                    </div>
                </div>
            </div>
        </div>

        <br>
        
        <div class="row">
            <div class="col-lg-12">
                <app-boq-list-table #boqListTable (selectBoqEvent)="onSelectBoqOnTable($event)" (editQtyEvent)="openQtyEditModal($event)"></app-boq-list-table>
            </div>
        </div>
    </div>


    <!--Edit Original BOQ Modal-->
    <ng-template #editModal let-modal>
        <form [formGroup]="formEdit" (ngSubmit)="onEditSubmit(true)">
            <div class="modal-header">
                <h4 class="modal-title" id="modal-basic-title">Edit Qty</h4>
                <button type="button" class="btn close" aria-label="Close" (click)="modal.dismiss('Cross click')">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>

            <div class="modal-body">
                <div class="row">

                    <div class="form-group p-2">
                        <label>Bill Qty</label>
                        <br>
                        <ng-container>
                            <strong>{{SelectedOriginalBoqRow.billQtyO | number: '.2'}}</strong>
                        </ng-container>

                        <!-- <label type="number" class="form-control" formControlName="userName"
                [ngClass]="{ 'is-invalid': submitted && f.userName.errors }"  >
                <div *ngIf="submitted && f.userName.errors" class="invalid-feedback">
                    <div *ngIf="f.userName.errors?.required">Username is required</div>
                </div> -->
                    </div>
                    <div class="form-group p-2">
                        <label>Final Qty</label>
                        <br>
                        <ng-container>
                            <strong>{{SelectedOriginalBoqRow.qtyO | number: '.2'}}</strong>
                        </ng-container>
                    </div>
                    <div class="form-group p-2">
                        <label>Qty</label>
                        <input type="number" class="form-control" formControlName="QtyScope"
                            [ngClass]="{ 'is-invalid': submitted && f.QtyScope.errors  || (f.QtyScope.value > SelectedOriginalBoqRow.qtyO )}">
                        <div *ngIf="submitted && f.QtyScope.errors || (f.QtyScope.value > SelectedOriginalBoqRow.qtyO ) "
                            class="invalid-feedback">
                            <div *ngIf="f.QtyScope.errors?.required">Qty is required</div>
                            <div *ngIf="f.QtyScope.value > SelectedOriginalBoqRow.qtyO">Invalid Qty</div>
                        </div>
                    </div>

                </div>
            </div>
            <div class="modal-footer">
                <ng-container *ngIf="f.QtyScope.value <= SelectedOriginalBoqRow.qtyO">
                    <button type="submit" class="btn btn-primary" [disabled]="updating">
                        <span *ngIf="updating" class="spinner-border spinner-border-sm mr-1"></span>Update</button>
                </ng-container>
                <button type="button" class="btn btn-secondary" (click)="modal.close('Cancel click')">Cancel</button>
            </div>
        </form>
    </ng-template>

    <!--Edit BOQ Resssources Modal-->
    <ng-template #editRessourcesModal let-modal>
        <form [formGroup]="formEdit" (ngSubmit)="onEditSubmit(false)">
            <div class="modal-header">
                <h4 class="modal-title" id="modal-basic-title">Edit Qty</h4>
                <button type="button" class="btn close" aria-label="Close" (click)="modal.dismiss('Cross click')">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>

            <div class="modal-body">
                <div class="row">

                    <div class="form-group p-2">
                        <label>Bill Qty</label>
                        <br>
                        <ng-container>
                            <strong>{{SelectedBoqRow.boqBillQty | number: '.2'}}</strong>
                        </ng-container>

                        <!-- <label type="number" class="form-control" formControlName="userName"
                [ngClass]="{ 'is-invalid': submitted && f.userName.errors }"  >
                <div *ngIf="submitted && f.userName.errors" class="invalid-feedback">
                    <div *ngIf="f.userName.errors?.required">Username is required</div>
                </div> -->
                    </div>
                    <div class="form-group p-2">
                        <label>Final Qty</label>
                        <br>
                        <ng-container>
                            <strong>{{SelectedBoqRow.boqQty | number: '.2'}}</strong>
                        </ng-container>
                    </div>
                    <div class="form-group p-2">
                        <label>Qty</label>
                        <input type="number" class="form-control" formControlName="QtyScope"
                            [ngClass]="{ 'is-invalid': submitted && f.QtyScope.errors  || (f.QtyScope.value > SelectedBoqRow.boqQty )}">
                        <div *ngIf="submitted && f.QtyScope.errors || (f.QtyScope.value > SelectedBoqRow.boqQty ) "
                            class="invalid-feedback">
                            <div *ngIf="f.QtyScope.errors?.required">Qty is required</div>
                            <div *ngIf="f.QtyScope.value > SelectedBoqRow.boqQty">Invalid Qty</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <ng-container *ngIf="f.QtyScope.value <= SelectedBoqRow.boqQty">
                    <button type="submit" class="btn btn-primary" [disabled]="updating">
                        <span *ngIf="updating" class="spinner-border spinner-border-sm mr-1"></span>Update</button>
                </ng-container>
                <button type="button" class="btn btn-secondary" (click)="modal.close('Cancel click')">Cancel</button>
            </div>
        </form>
    </ng-template>
</section>